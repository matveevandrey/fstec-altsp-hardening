# üõ°Ô∏è ALT SP Reference Compliance Toolkit

## üìò –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

**`fix_altsp_reference.sh`** –∏ **`check_altsp_reference.sh`** ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π
–ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –û–° **–ê–ª—å—Ç –õ–∏–Ω—É–∫—Å –°–ü**  
–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å *–≠—Ç–∞–ª–æ–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏* –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–µ–∏—è –∞—Ç—Ç–µ—Å—Ç–∞—Ü–∏–∏ –ø–æ 152–§–ó –ö–°2

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏–∑:
- üìã **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–π –≠—Ç–∞–ª–æ–Ω–Ω–æ–π –û–° (–æ—Ç –∞—Ç—Ç–µ—Å—Ç–∞—Ç–æ—Ä–∞)**

To Do: –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–≤–µ—Ä–∫—É —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ:
- üìÑ  **–ú–µ—Ç–æ–¥–∏–∫–∏ –æ—Ü–µ–Ω–∫–∏ —É–≥—Ä–æ–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –§–°–¢–≠–ö (05.02.2021)**
- ‚öñÔ∏è **–§–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∑–∞–∫–æ–Ω–∞ ‚Ññ152-–§–ó**
- üß© **–ü—Ä–∏–∫–∞–∑–∞ –§–°–¢–≠–ö ‚Ññ21 –æ—Ç 18.02.2013**

---

## ‚öôÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|-------------|
| `check_altsp_reference.sh` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —ç—Ç–∞–ª–æ–Ω–Ω–æ–π |
| `fix_altsp_reference.sh` | –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∫ —ç—Ç–∞–ª–æ–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (—Ä–µ–∂–∏–º `--fix`) |
| `README.md` | –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –ø–µ—Ä–µ—á–µ–Ω—å –ø—Ä–æ–≤–µ—Ä–æ–∫ |
| `logs/compliance_report_*.log` | –õ–æ–≥–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫ —Å –æ—Ç–º–µ—Ç–∫–∞–º–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è |

---

## üîç –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ —Å–ø–æ—Å–æ–±–æ–≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è –∫ —ç—Ç–∞–ª–æ–Ω—É

| ‚Ññ | –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ü—Ä–æ–≤–µ—Ä—è–µ–º–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ | –≠—Ç–∞–ª–æ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ | –°–ø–æ—Å–æ–± –∑–∞–∫—Ä—ã—Ç–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è |
|:-:|------------|-----------------------|--------------------|-----------------------------|
| **1** | –ü–æ–ª–∏—Ç–∏–∫–∞ –ø–∞—Ä–æ–ª–µ–π | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è (`minlen`) | `12` | –ü—Ä–∞–≤–∫–∞ `/etc/security/pwquality.conf`: `minlen = 12` |
| **2** | –ü–æ–ª–∏—Ç–∏–∫–∞ –ø–∞—Ä–æ–ª–µ–π | –°—Ç—Ä–æ—á–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (`lcredit`) | `1` –∏–ª–∏ `-1` | `/etc/security/pwquality.conf`: `lcredit = 1` |
| **3** | –ü–æ–ª–∏—Ç–∏–∫–∞ –ø–∞—Ä–æ–ª–µ–π | –ó–∞–≥–ª–∞–≤–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (`ucredit`) | `1` –∏–ª–∏ `-1` | `/etc/security/pwquality.conf`: `ucredit = 1` |
| **4** | –ü–æ–ª–∏—Ç–∏–∫–∞ –ø–∞—Ä–æ–ª–µ–π | –¶–∏—Ñ—Ä—ã (`dcredit`) | `1` –∏–ª–∏ `-1` | `/etc/security/pwquality.conf`: `dcredit = 1` |
| **5** | –ü–æ–ª–∏—Ç–∏–∫–∞ –ø–∞—Ä–æ–ª–µ–π | –°–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã (`ocredit`) | `1` –∏–ª–∏ `-1` | `/etc/security/pwquality.conf`: `ocredit = 1` |
| **6** | –ü–æ–ª–∏—Ç–∏–∫–∞ –ø–∞—Ä–æ–ª–µ–π | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª—è | `90` –¥–Ω–µ–π | `/etc/login.defs`: `PASS_MAX_DAYS 90` |
| **7** | –ü–æ–ª–∏—Ç–∏–∫–∞ –ø–∞—Ä–æ–ª–µ–π | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å—Ä–æ–∫ –º–µ–∂–¥—É —Å–º–µ–Ω–∞–º–∏ | `0` –¥–Ω–µ–π | `/etc/login.defs`: `PASS_MIN_DAYS 0` |
| **8** | –ü–æ–ª–∏—Ç–∏–∫–∞ –ø–∞—Ä–æ–ª–µ–π | –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–± –æ–∫–æ–Ω—á–∞–Ω–∏–∏ —Å—Ä–æ–∫–∞ | `7` –¥–Ω–µ–π | `/etc/login.defs`: `PASS_WARN_AGE 7` |
| **9** | –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (`chage`) | `min=0`, `max=90`, `warn=7` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ `chage -m 0 -M 90 -W 7 <user>` |
| **10** | –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ (`deny`) | `5` | `/etc/security/faillock.conf`: `deny = 5` |
| **11** | –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π | –í—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (`unlock_time`) | `900` —Å–µ–∫ (15 –º–∏–Ω) | `/etc/security/faillock.conf`: `unlock_time = 900` |
| **12** | –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π | PAM-–º–æ–¥—É–ª—å `pam_faillock` | –ê–∫—Ç–∏–≤–µ–Ω | –í—Å—Ç–∞–≤–∫–∞ –≤ `/etc/pam.d/system-auth-local-only` –¥–æ `pam_tcb.so` |
| **13** | –û—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏ | `vm.swappiness` | ‚â§ 60 | `/etc/sysctl.d/90-altsp-etalon.conf`: `vm.swappiness = 60` |
| **14** | –û—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏ | –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ | –£—Ç–∏–ª–∏—Ç–∞ `secure_delete` | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–∞ `secure_delete` |
| **15** | –ê—É–¥–∏—Ç | –°–ª—É–∂–±–∞ `auditd` | –ê–∫—Ç–∏–≤–Ω–∞ | `systemctl enable --now auditd` |
| **16** | –ê—É–¥–∏—Ç | –ú–∞—Å–∫–∞ –æ—Ç–∫–∞–∑–æ–≤ | `ocxudntligarmphew` | –î–æ–±–∞–≤–∏—Ç—å –≤ `/etc/audit/audit.rules` |
| **17** | –ê—É–¥–∏—Ç | –ú–∞—Å–∫–∞ —É—Å–ø–µ—Ö–æ–≤ | `cxuth` | –î–æ–±–∞–≤–∏—Ç—å –≤ `/etc/audit/audit.rules` |
| **18** | –ú–∞–Ω–¥–∞—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ | –ü–æ–¥—Å–∏—Å—Ç–µ–º—ã `ima-evm` –∏ `integalert` | –û—Ç–∫–ª—é—á–µ–Ω—ã | `systemctl disable --now ima-evm integalert` |
| **19** | –ú–∞–Ω–¥–∞—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ | –ü–∞—Ä–∞–º–µ—Ç—Ä —è–¥—Ä–∞ `ima_policy` | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | –£–¥–∞–ª–∏—Ç—å –∏–∑ `/etc/default/grub` –∏ –æ–±–Ω–æ–≤–∏—Ç—å `grub.cfg` |
| **20** | –ó–∞–º–∫–Ω—É—Ç–∞—è —Å—Ä–µ–¥–∞ | –°–ª—É–∂–±–∞ `control++` | –û—Ç–∫–ª—é—á–µ–Ω–∞ | `systemctl disable --now control++` |
| **21** | –ó–∞–º–∫–Ω—É—Ç–∞—è —Å—Ä–µ–¥–∞ | –ü–æ–ª–∏—Ç–∏–∫–∏ `control++` | –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç | –û—á–∏—Å—Ç–∏—Ç—å `/etc/control++/rules.d/` |
| **22** | –ó–∞–º–∫–Ω—É—Ç–∞—è —Å—Ä–µ–¥–∞ | –§–∞–π–ª—ã —Å –∞—Ç—Ä–∏–±—É—Ç–æ–º `immutable` | –ù–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è | `find ... | xargs chattr -i` |

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
```bash
bash check_altsp_reference.sh
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –û–° –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å–∏–∏ —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ —ç—Ç–∞–ª–æ–Ω–Ω–æ–π –û–°
```bash
bash fix_altsp_reference.sh --fix
```
